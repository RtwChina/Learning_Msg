**B+树**

标签：【算法】【查找】

# 1.B+树
B+树是B树的一种变形，==它更适合实际应用中操作系统的文件索引和数据库索引==，定义如下（使用阶数m来定义B+树）：
1. 除根节点外的内部节点，每个节点最多有m个关键字，最少有[m/2]个关键字。其中每个关键字对应一个子树（也就是最多有m棵子树，最少有[m/2]棵子树）；
2. 根节点要么没有子树，要么至少有2棵子树.
3. ==所有的叶子结点包含了全部的关键字已经这些关键字指向文件的指针==，并且：
- 所有叶子节点中的关键字按大小顺序排列。
- 相邻的叶子节点顺序链接(相当于是构成了一个顺序链表)。
- 所有叶子节点在同一层。
4. **所有分支节点的关键字都是对应子树中关键字的最大值**。

#2. B+树示例
![B+树图示](http://rtt-picture.oss-cn-hangzhou.aliyuncs.com/2019-02-03-135800.png)

1. 红点表示是指向卫星数据的指针，指针指向的是存放实际数据的磁盘页，卫星数据就是数据库中一条数据记录。

2. 叶子节点中还有一个指向下一个叶子节点的next指针，==所以叶子节点形成了一个有序的链表==，方便遍历B+树。





#3. B+树 与 B树 比较

##3.1 B+树 与 B树 区别
1. 内部节点中，关键字的个数与子树的个数相同，不像B树中子树的个数总比关键字个数多1个。
2. 所有指向文件的关键字及其指针都在叶子节点中，不像B树，有的指向文件的关键字是在内部节点中。换句话说，B+树中，内部节点仅仅起到索引的作用。
3. 在搜索过程中，如果查询和内部节点的关键字一致，那么搜索过程不停止，而是继续向下搜素这个分支。

##3.2 B+树 比 B树 的优点
1. B+树的磁盘读写代价更低：B+树的内部节点并没有指向关键字具体信息的指针。因此其内部节点相对B树更小。如果把所有同一内部结点的关键字存放在同一盘块中，那么盘块所能容纳的关键字数量也越多。**一次性读入内存中的需要查找的关键字也就越多。相对来说IO读写次数也就降低了**。
2. B+树的查询效率更加稳定：由于内部结点并不是最终指向文件内容的结点，而只是叶子结点中关键字的索引。**所以任何关键字的查找必须走一条从根结点到叶子结点的路**。所有关键字查询的路径长度相同，导致每一个数据的查询效率相当。
3. B+树更有利于对数据库的扫描：B树在提高了磁盘IO性能的同时并没有解决元素遍历的效率低下的问题，而B+树只需要遍历叶子节点就可以解决对全部关键字信息的扫描，==所以对于数据库中频繁使用的range query，B+树有着更高的性能。==

















